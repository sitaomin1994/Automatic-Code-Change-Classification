{"application": "google-caja", "csha": "a7c693caf2d3e953e554a83091a4499b9fa09e54", "files": [{"CssRewriter_cluster": {"actions": [{"root": "MOVE from VariableDeclarationStatement", "operations": ["MOV ParameterizedType: Set<Name> to VariableDeclarationStatement at 0"]}, {"root": "INS QualifiedName: LinkStyleWhitelist.PROPERTIES_ALLOWED_IN_LINK_CLASSES to VariableDeclarationFragment at 1", "operations": ["INS QualifiedName: LinkStyleWhitelist.PROPERTIES_ALLOWED_IN_LINK_CLASSES to VariableDeclarationFragment at 1"]}, {"root": "DEL FieldDeclaration", "operations": ["DEL SimpleName: Set", "DEL VariableDeclarationFragment", "DEL Modifier: private", "DEL SimpleName: PROPERTIES_ALLOWED_IN_LINK_CLASSES", "DEL Modifier: static", "DEL Modifier: final", "DEL SimpleType: Set", "DEL SimpleName: Name", "DEL ParameterizedType: Set<Name>", "DEL SimpleType: Name", "DEL FieldDeclaration"]}, {"root": "DEL Initializer", "operations": ["DEL SimpleName: propNames", "DEL SimpleName: css", "DEL MethodInvocation", "DEL MethodInvocation", "DEL MethodInvocation", "DEL SimpleType: Name", "DEL QualifiedName: CssPropertyPatterns.HISTORY_INSENSITIVE_STYLE_WHITELIST", "DEL VariableDeclarationStatement", "DEL VariableDeclarationFragment", "DEL SimpleName: Name", "DEL SimpleName: PROPERTIES_ALLOWED_IN_LINK_CLASSES", "DEL SimpleName: Set", "DEL SimpleName: immutableSet", "DEL SimpleName: computedStyleNames", "DEL SimpleName: newHashSet", "DEL SimpleName: Name", "DEL SimpleName: computedStyleNames", "DEL Block", "DEL SimpleName: Name", "DEL SimpleName: css", "DEL SimpleType: Set", "DEL MethodInvocation", "DEL SimpleName: propNames", "DEL SimpleName: css", "DEL SimpleName: propNames", "DEL Assignment: =", "DEL VariableDeclarationFragment", "DEL StringLiteral: \"cursor\"", "DEL Initializer", "DEL SimpleName: Sets", "DEL SimpleName: removeAll", "DEL SimpleName: Name", "DEL StringLiteral: \"background-color\"", "DEL ParameterizedType: Set<Name>", "DEL MethodInvocation", "DEL StringLiteral: \"color\"", "DEL ExpressionStatement", "DEL Modifier: static", "DEL MethodInvocation", "DEL VariableDeclarationStatement", "DEL ExpressionStatement", "DEL SimpleName: Sets"]}, {"root": "DEL ParameterizedType: Set<Name>", "operations": ["DEL SimpleName: Name", "DEL SimpleName: Set", "DEL ParameterizedType: Set<Name>", "DEL SimpleType: Name", "DEL SimpleType: Set"]}, {"root": "DEL SimpleName: PROPERTIES_ALLOWED_IN_LINK_CLASSES", "operations": ["DEL SimpleName: PROPERTIES_ALLOWED_IN_LINK_CLASSES"]}]}}, {"CssRewriter_diff": {"operations": ["Move ParameterizedType: Set<Name>(3097) into VariableDeclarationStatement(3109) at 0", "Insert QualifiedName: LinkStyleWhitelist.PROPERTIES_ALLOWED_IN_LINK_CLASSES(3107) into VariableDeclarationFragment(3108) at 1", "Delete Modifier: private(3081)", "Delete Modifier: static(3082)", "Delete Modifier: final(3083)", "Delete SimpleName: Set(3084)", "Delete SimpleType: Set(3085)", "Delete SimpleName: Name(3086)", "Delete SimpleType: Name(3087)", "Delete ParameterizedType: Set<Name>(3088)", "Delete SimpleName: PROPERTIES_ALLOWED_IN_LINK_CLASSES(3089)", "Delete VariableDeclarationFragment(3090)", "Delete FieldDeclaration(3091)", "Delete Modifier: static(3092)", "Delete SimpleName: propNames(3098)", "Delete SimpleName: Sets(3099)", "Delete SimpleName: newHashSet(3100)", "Delete SimpleName: Name(3101)", "Delete SimpleName: css(3102)", "Delete StringLiteral: \"background-color\"(3103)", "Delete MethodInvocation(3104)", "Delete SimpleName: Name(3105)", "Delete SimpleName: css(3106)", "Delete StringLiteral: \"color\"(3107)", "Delete MethodInvocation(3108)", "Delete SimpleName: Name(3109)", "Delete SimpleName: css(3110)", "Delete StringLiteral: \"cursor\"(3111)", "Delete MethodInvocation(3112)", "Delete MethodInvocation(3113)", "Delete VariableDeclarationFragment(3114)", "Delete VariableDeclarationStatement(3115)", "Delete SimpleName: Set(3116)", "Delete SimpleType: Set(3117)", "Delete SimpleName: Name(3118)", "Delete SimpleType: Name(3119)", "Delete ParameterizedType: Set<Name>(3120)", "Delete SimpleName: computedStyleNames(3121)", "Delete QualifiedName: CssPropertyPatterns.HISTORY_INSENSITIVE_STYLE_WHITELIST(3122)", "Delete VariableDeclarationFragment(3123)", "Delete VariableDeclarationStatement(3124)", "Delete SimpleName: propNames(3125)", "Delete SimpleName: removeAll(3126)", "Delete SimpleName: computedStyleNames(3127)", "Delete MethodInvocation(3128)", "Delete ExpressionStatement(3129)", "Delete SimpleName: PROPERTIES_ALLOWED_IN_LINK_CLASSES(3130)", "Delete SimpleName: Sets(3131)", "Delete SimpleName: immutableSet(3132)", "Delete SimpleName: propNames(3133)", "Delete MethodInvocation(3134)", "Delete Assignment: =(3135)", "Delete ExpressionStatement(3136)", "Delete Block(3137)", "Delete Initializer(3138)", "Delete SimpleName: Set(3159)", "Delete SimpleType: Set(3160)", "Delete SimpleName: Name(3161)", "Delete SimpleType: Name(3162)", "Delete ParameterizedType: Set<Name>(3163)", "Delete SimpleName: PROPERTIES_ALLOWED_IN_LINK_CLASSES(3165)"]}}, {"CssPropBit_cluster": {"actions": [{"root": "INS EnumConstantDeclaration to EnumDeclaration at 10", "operations": ["INS SimpleName: ALLOWED_IN_LINK to EnumConstantDeclaration at 1", "INS Javadoc to EnumConstantDeclaration at 0", "INS TagElement to Javadoc at 0", "INS EnumConstantDeclaration to EnumDeclaration at 10", "INS TextElement: Allowed to be specified in a history-sensitive manner in a CSS stylesheet. to TagElement at 0", "INS NumberLiteral: 128 to EnumConstantDeclaration at 2"]}, {"root": "INS Javadoc to EnumConstantDeclaration at 0", "operations": ["INS TextElement: as if the link were not visited. to TagElement at 1", "INS TagElement to Javadoc at 0", "INS TextElement: Allowed to be read via computed style directly without computing the style to TagElement at 0", "INS Javadoc to EnumConstantDeclaration at 0"]}]}}, {"CssPropBit_diff": {"operations": ["Insert EnumConstantDeclaration(39) into EnumDeclaration(61) at 10", "Insert Javadoc(27) into EnumConstantDeclaration(30) at 0", "Insert Javadoc(36) into EnumConstantDeclaration(39) at 0", "Insert SimpleName: ALLOWED_IN_LINK(37) into EnumConstantDeclaration(39) at 1", "Insert NumberLiteral: 128(38) into EnumConstantDeclaration(39) at 2", "Insert TagElement(26) into Javadoc(27) at 0", "Insert TagElement(35) into Javadoc(36) at 0", "Insert TextElement: Allowed to be read via computed style directly without computing the style(24) into TagElement(26) at 0", "Insert TextElement: as if the link were not visited.(25) into TagElement(26) at 1", "Insert TextElement: Allowed to be specified in a history-sensitive manner in a CSS stylesheet.(34) into TagElement(35) at 0"]}}, {"CssPropertyPatterns_cluster": {"actions": [{"root": "INS ImportDeclaration to CompilationUnit at 26", "operations": ["INS QualifiedName: com.google.caja.plugin.LinkStyleWhitelist to ImportDeclaration at 0", "INS ImportDeclaration to CompilationUnit at 26"]}, {"root": "INS IfStatement to Block at 13", "operations": ["INS Assignment: |= to ExpressionStatement at 0", "INS ExpressionStatement to Block at 0", "INS QualifiedName: LinkStyleWhitelist.HISTORY_INSENSITIVE_STYLE_WHITELIST to MethodInvocation at 0", "INS QualifiedName: CssPropBit.ALLOWED_IN_LINK.jsValue to Assignment: |= at 1", "INS MethodInvocation to IfStatement at 0", "INS IfStatement to IfStatement at 2", "INS QualifiedName: prop.name to MethodInvocation at 2", "INS SimpleName: contains to MethodInvocation at 1", "INS SimpleName: propBits to Assignment: |= at 0", "INS IfStatement to Block at 13", "INS Block to IfStatement at 1"]}, {"root": "MOVE from IfStatement", "operations": ["MOV Block to IfStatement at 1", "MOV MethodInvocation to IfStatement at 0"]}, {"root": "INS QualifiedName: LinkStyleWhitelist.PROPERTIES_ALLOWED_IN_LINK_CLASSES to MethodInvocation at 0", "operations": ["INS QualifiedName: LinkStyleWhitelist.PROPERTIES_ALLOWED_IN_LINK_CLASSES to MethodInvocation at 0"]}, {"root": "DEL FieldDeclaration", "operations": ["DEL StringLiteral: \"overflow\"", "DEL SimpleName: css", "DEL TextElement: user's history as described at", "DEL MethodInvocation", "DEL SimpleName: css", "DEL SimpleName: Name", "DEL SimpleName: Name", "DEL Javadoc", "DEL SimpleName: css", "DEL StringLiteral: \"display\"", "DEL SimpleName: css", "DEL TextElement: predicate). Otherwise, it would allow an attacker to probe the", "DEL SimpleName: Name", "DEL StringLiteral: \"visibility\"", "DEL SimpleName: Name", "DEL MethodInvocation", "DEL SimpleName: Name", "DEL MethodInvocation", "DEL TextElement: Set of properties accessible on computed style of an anchor", "DEL SimpleName: Name", "DEL StringLiteral: \"top\"", "DEL SimpleType: Set", "DEL SimpleName: Sets", "DEL SimpleName: Name", "DEL TextElement: is prevented from specifying ANY of these properties in a history", "DEL MethodInvocation", "DEL VariableDeclarationFragment", "DEL SimpleName: Name", "DEL MethodInvocation", "DEL MethodInvocation", "DEL MethodInvocation", "DEL MethodInvocation", "DEL SimpleName: css", "DEL Modifier: static", "DEL MethodInvocation", "DEL SimpleName: Name", "DEL SimpleName: Name", "DEL MethodInvocation", "DEL StringLiteral: \"padding-right\"", "DEL SimpleName: css", "DEL SimpleName: css", "DEL StringLiteral: \"padding-top\"", "DEL SimpleName: Set", "DEL SimpleName: css", "DEL SimpleName: Name", "DEL StringLiteral: \"float\"", "DEL MethodInvocation", "DEL StringLiteral: \"left\"", "DEL MethodInvocation", "DEL MethodInvocation", "DEL SimpleName: Name", "DEL SimpleType: Name", "DEL SimpleName: immutableSet", "DEL SimpleName: HISTORY_INSENSITIVE_STYLE_WHITELIST", "DEL StringLiteral: \"filter\"", "DEL TextElement: https://bugzilla.mozilla.org/show_bug.cgi?id=147777 .", "DEL MethodInvocation", "DEL StringLiteral: \"padding-bottom\"", "DEL TextElement: sensitive manner (i.e., in a rule with a \":link\" or \":visited\"", "DEL SimpleName: css", "DEL StringLiteral: \"position\"", "DEL SimpleName: css", "DEL StringLiteral: \"height\"", "DEL ParameterizedType: Set<Name>", "DEL SimpleName: Name", "DEL StringLiteral: \"width\"", "DEL FieldDeclaration", "DEL SimpleName: css", "DEL SimpleName: Name", "DEL TextElement: containment, and layout calculations. It REQUIRES that user CSS", "DEL SimpleName: css", "DEL SimpleName: Name", "DEL StringLiteral: \"opacity\"", "DEL TextElement: (&lt;A&gt;) element or some element nested within an anchor. This", "DEL Modifier: public", "DEL SimpleName: css", "DEL TagElement", "DEL StringLiteral: \"right\"", "DEL StringLiteral: \"padding-left\"", "DEL MethodInvocation", "DEL SimpleName: css", "DEL TextElement: list is a conservative one based on the ability to do visibility,", "DEL MethodInvocation", "DEL SimpleName: Name", "DEL SimpleName: css", "DEL SimpleName: css", "DEL SimpleName: Name", "DEL MethodInvocation"]}, {"root": "DEL SimpleName: HISTORY_INSENSITIVE_STYLE_WHITELIST", "operations": ["DEL SimpleName: HISTORY_INSENSITIVE_STYLE_WHITELIST"]}, {"root": "DEL IfStatement", "operations": ["DEL IfStatement"]}]}}, {"CssPropertyPatterns_diff": {"operations": ["Insert ImportDeclaration(53) into CompilationUnit(4797) at 26", "Insert QualifiedName: com.google.caja.plugin.LinkStyleWhitelist(52) into ImportDeclaration(53) at 0", "Insert IfStatement(3464) into Block(3533) at 13", "Insert MethodInvocation(3448) into IfStatement(3464) at 0", "Move Block(3539) into IfStatement(3464) at 1", "Insert IfStatement(3463) into IfStatement(3464) at 2", "Insert QualifiedName: LinkStyleWhitelist.HISTORY_INSENSITIVE_STYLE_WHITELIST(3445) into MethodInvocation(3448) at 0", "Insert SimpleName: contains(3446) into MethodInvocation(3448) at 1", "Insert QualifiedName: prop.name(3447) into MethodInvocation(3448) at 2", "Move MethodInvocation(3534) into IfStatement(3463) at 0", "Insert Block(3462) into IfStatement(3463) at 1", "Insert QualifiedName: LinkStyleWhitelist.PROPERTIES_ALLOWED_IN_LINK_CLASSES(3454) into MethodInvocation(3457) at 0", "Insert ExpressionStatement(3461) into Block(3462) at 0", "Insert Assignment: |=(3460) into ExpressionStatement(3461) at 0", "Insert SimpleName: propBits(3458) into Assignment: |=(3460) at 0", "Insert QualifiedName: CssPropBit.ALLOWED_IN_LINK.jsValue(3459) into Assignment: |=(3460) at 1", "Delete TextElement: Set of properties accessible on computed style of an anchor(216)", "Delete TextElement: (&lt;A&gt;) element or some element nested within an anchor. This(217)", "Delete TextElement: list is a conservative one based on the ability to do visibility,(218)", "Delete TextElement: containment, and layout calculations. It REQUIRES that user CSS(219)", "Delete TextElement: is prevented from specifying ANY of these properties in a history(220)", "Delete TextElement: sensitive manner (i.e., in a rule with a \":link\" or \":visited\"(221)", "Delete TextElement: predicate). Otherwise, it would allow an attacker to probe the(222)", "Delete TextElement: user's history as described at(223)", "Delete TextElement: https://bugzilla.mozilla.org/show_bug.cgi?id=147777 .(224)", "Delete TagElement(225)", "Delete Javadoc(226)", "Delete Modifier: public(227)", "Delete Modifier: static(228)", "Delete SimpleName: Set(229)", "Delete SimpleType: Set(230)", "Delete SimpleName: Name(231)", "Delete SimpleType: Name(232)", "Delete ParameterizedType: Set<Name>(233)", "Delete SimpleName: HISTORY_INSENSITIVE_STYLE_WHITELIST(234)", "Delete SimpleName: Sets(235)", "Delete SimpleName: immutableSet(236)", "Delete SimpleName: Name(237)", "Delete SimpleName: css(238)", "Delete StringLiteral: \"display\"(239)", "Delete MethodInvocation(240)", "Delete SimpleName: Name(241)", "Delete SimpleName: css(242)", "Delete StringLiteral: \"filter\"(243)", "Delete MethodInvocation(244)", "Delete SimpleName: Name(245)", "Delete SimpleName: css(246)", "Delete StringLiteral: \"float\"(247)", "Delete MethodInvocation(248)", "Delete SimpleName: Name(249)", "Delete SimpleName: css(250)", "Delete StringLiteral: \"height\"(251)", "Delete MethodInvocation(252)", "Delete SimpleName: Name(253)", "Delete SimpleName: css(254)", "Delete StringLiteral: \"left\"(255)", "Delete MethodInvocation(256)", "Delete SimpleName: Name(257)", "Delete SimpleName: css(258)", "Delete StringLiteral: \"opacity\"(259)", "Delete MethodInvocation(260)", "Delete SimpleName: Name(261)", "Delete SimpleName: css(262)", "Delete StringLiteral: \"overflow\"(263)", "Delete MethodInvocation(264)", "Delete SimpleName: Name(265)", "Delete SimpleName: css(266)", "Delete StringLiteral: \"position\"(267)", "Delete MethodInvocation(268)", "Delete SimpleName: Name(269)", "Delete SimpleName: css(270)", "Delete StringLiteral: \"right\"(271)", "Delete MethodInvocation(272)", "Delete SimpleName: Name(273)", "Delete SimpleName: css(274)", "Delete StringLiteral: \"top\"(275)", "Delete MethodInvocation(276)", "Delete SimpleName: Name(277)", "Delete SimpleName: css(278)", "Delete StringLiteral: \"visibility\"(279)", "Delete MethodInvocation(280)", "Delete SimpleName: Name(281)", "Delete SimpleName: css(282)", "Delete StringLiteral: \"width\"(283)", "Delete MethodInvocation(284)", "Delete SimpleName: Name(285)", "Delete SimpleName: css(286)", "Delete StringLiteral: \"padding-left\"(287)", "Delete MethodInvocation(288)", "Delete SimpleName: Name(289)", "Delete SimpleName: css(290)", "Delete StringLiteral: \"padding-right\"(291)", "Delete MethodInvocation(292)", "Delete SimpleName: Name(293)", "Delete SimpleName: css(294)", "Delete StringLiteral: \"padding-top\"(295)", "Delete MethodInvocation(296)", "Delete SimpleName: Name(297)", "Delete SimpleName: css(298)", "Delete StringLiteral: \"padding-bottom\"(299)", "Delete MethodInvocation(300)", "Delete MethodInvocation(301)", "Delete VariableDeclarationFragment(302)", "Delete FieldDeclaration(303)", "Delete SimpleName: HISTORY_INSENSITIVE_STYLE_WHITELIST(3531)", "Delete IfStatement(3540)"]}}], "commit_stats": [{"total_files": 10, "deleted_files": 3, "testing": "True", "maintenance": "False", "build": "False"}]}